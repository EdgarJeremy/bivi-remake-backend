(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{562:function(e,t,a){"use strict";a.r(t);var n=a(10),r=a(11),s=a(13),l=a(12),c=a(14),o=a(0),i=a.n(o),m=a(305),u=a(533),d=a(42),p=a(21),h=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(c)))).state={operator:0,active:!1},a.componentDidMount=function(){a.setState({operator:a.props.operator_left})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=new Date,t=new Date(this.props.date),a="".concat(e.getFullYear(),"/").concat(e.getMonth(),"/").concat(e.getDate()),n="".concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds());return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"col-sm-6 col-md-3"},this.props.operator_left>0?Date.parse("".concat(a," ").concat(n))>Date.parse("".concat(t.getFullYear(),"/").concat(t.getMonth(),"/").concat(t.getDate()," ").concat(this.props.time))?i.a.createElement("div",{className:"card my-1 mx-1 bg-dark border-0",title:"Penuh"},i.a.createElement("div",{className:"card-body p-2 position-relative text-white"},i.a.createElement("h4",{className:"m-0 text-center"},this.props.time))):i.a.createElement("div",{onClick:this.props.onClick,id:this.props.idClock,className:"card hour-options my-1 mx-2 ".concat(this.props.active?"active-time":"")},i.a.createElement("div",{className:"card-body p-2 position-relative"},i.a.createElement("h4",{className:"m-0 text-center"},this.props.time)," ",i.a.createElement("span",{className:"front-office shadow-sm"},this.state.operator))):i.a.createElement("div",{className:"card my-1 mx-1 bg-danger border-0",title:"Penuh"},i.a.createElement("div",{className:"card-body p-2 position-relative text-white"},i.a.createElement("h4",{className:"m-0 text-center"},this.props.time)))))}}]),t}(o.Component),g=a(20),f=a.n(g),E=a(189),b=a.n(E),k=a(153),v=a(555),y=a(556),N=a(540),S=a(553),j=a(546),M=a(548),O=a(557),x=a(558),C=a(151),D=a(152),w=a(565),Y=a(544),_=a(545),q=a(536),P=a(535),A=a(160),F=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(c)))).state={img:"",error:!1},a.onDrop=function(e){if(e.length>0){var t=e[0];Object(P.a)(t,{maxSizeMB:1,maxWidthOrHeight:1200}).then(function(e){var t=new FileReader;t.onload=function(e){var t=e.target.result;a.setState({img:t},function(){return a.props.onSelect({name:a.props.file,data:t,error:!1})})},t.readAsDataURL(e)}).catch(function(e){alert(e.toString())})}},a.cancel=function(){a.setState({img:""},function(){a.props.onCancel(a.props.file)})},a.reject=function(e){console.log(e),a.setState({error:!0})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.state.error;return i.a.createElement("div",{className:"col-md-3 h-100"},""!==this.state.img&&i.a.createElement("div",{className:"card border-0 shadow h-100 my-2"},i.a.createElement("div",{className:"card-body p-1 w-100"},i.a.createElement(M.a,{block:!0,size:"sm",color:"danger",onClick:this.cancel},"Batal")),i.a.createElement("img",{src:this.state.img,alt:"testing",className:"card-img"}),i.a.createElement("div",{className:"card-body p-1 text-center"},i.a.createElement("small",{className:"text-center"},this.props.file))),""===this.state.img&&i.a.createElement(q.a,{accept:["image/jpg","image/jpeg","image/png"],minSize:0,onDropRejected:this.reject,maxSize:5242880,onDrop:this.onDrop},function(a){var n=a.getRootProps,r=a.getInputProps;return i.a.createElement("div",Object.assign({className:"card my-2 h-100",style:{cursor:"pointer"}},n()),i.a.createElement("div",{className:"card-body h-100 text-center"},i.a.createElement("input",r()),i.a.createElement("p",{className:"".concat(e.props.required?"text-danger":"text-success"," m-0")},e.props.required?"Harus di-upload":"File Opsional"),i.a.createElement(A.i,{style:{fontSize:60},className:"text-dark"}),i.a.createElement("p",{className:"m-0"},"Seret file ",e.props.file," di sini, atau klik di sini untuk memilih file"),i.a.createElement("p",{className:"text-muted m-0 small"},"Format : jpg, jpeg, png"),i.a.createElement("p",{className:"text-muted m-0 small"},"Maksimal 5MB"),t&&i.a.createElement("p",{className:"text-danger m-1 small"},"File terlalu besar. Silakan pilih file dengan besar kurang dari 1MB")))}))}}]),t}(o.Component),T=a(229),z=a(170),R=a(72),B=a(154),L=a(542),J=a(543);a(77);f.a.locale("id");var H=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(c)))).state={open:!1},a.open=function(){return a.setState({open:!0})},a.close=function(){return a.setState({open:!1})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(i.a.Fragment,null,i.a.createElement(w.a,{isOpen:this.state.open},i.a.createElement(Y.a,{color:"danger"},"Konfirmasi Pendaftaran"),i.a.createElement(_.a,null,i.a.createElement("h4",{className:"m-0 text-center"},"Apakah Anda yakin mendaftar dengan data sebagai berikut")),i.a.createElement(B.a,null,i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Nama"),i.a.createElement("td",null,this.props.name)),i.a.createElement("tr",null,i.a.createElement("td",null,"Tujuan"),i.a.createElement("td",null,this.props.purpose)),i.a.createElement("tr",null,i.a.createElement("td",null,"Tanggal"),i.a.createElement("td",null,f()(this.props.date[0]).format("DD MMMM YYYY"))),i.a.createElement("tr",null,i.a.createElement("td",null,"Jam"),i.a.createElement("td",null,this.props.time)))),i.a.createElement(_.a,null,i.a.createElement(L.a,{noGutters:!0},i.a.createElement(J.a,{md:"6",className:"px-1"},i.a.createElement(M.a,{onClick:function(){return e.setState({open:!1})},block:!0,color:"light"},"Tidak")),i.a.createElement(J.a,{md:"6",className:"px-1"},i.a.createElement(M.a,{onClick:function(){return e.props.onClick()},block:!0,color:"success"},"Ya"))))))}}]),t}(o.Component),I=function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"bg-half"}),i.a.createElement("div",{className:"wrapper"},i.a.createElement("div",{className:"container my-5 py-5"},e.children)))},K=(a(190),function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(c)))).state={times:[],time:void 0,dates:[],date:[f()(new Date).format("YYYY-MM-DD")],minDate:[f()(new Date).format("YYYY-MM-DD")],loading:!1,clock:void 0,ready:!1,purposes:[],purpose:"",name:"",nik:"",phone:"",purpose_id:0,documents:[],requirements:[],captcha:"",queue:{},modal:!1,error:!1,submitting:!1,errors:{name:!1,nik:!1,phone:!1,purpose_id:!1,captcha:!1},submitErrors:{errors:[]},collapse:!1,clock_id:void 0,upload:!1,token:"",key:Math.random(),purpose_key:Math.random()},a.componentDidMount=function(){document.title="Daftar Antrian",a.getEnabledDate(),f.a.locale("id"),setInterval(function(){return a.setState({key:Math.random()})},18e4)},a.componentWillReceiveProps=function(e){""!==e.date&&""!==e.clock&&a.setState({date:e.date,time:e.clock})},a.getPurposes=function(){var e=a.props.models.Purpose,t=a.state.date;e.collection({limit:999,offset:0,where:{selected_date:f()(t[0]).format("YYYY-MM-DD")}}).then(function(e){var t=e.rows.map(function(e){return{value:e.id,label:"".concat(e.quota_exceeded?"[Kuota Penuh] ":"").concat(e.name),disabled:e.quota_exceeded}});a.setState({purposes:t})})},a.toggleClock=function(e,t,n){e===a.state.time?a.setState({time:void 0,clock:void 0,clock_id:n}):a.setState({time:e,clock:t,clock_id:n,collapse:!1})},a.getEnabledDate=function(){a.props.models.Schedule.collection({attributes:["date"]}).then(function(e){e.rows.length>0?a.setState({dates:e.rows.map(function(e){return e.date}),date:[e.rows[0].date],purposes:[],purpose:""},function(){return a.getHours(!0)}):a.setState({error:!0})})},a.getHours=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&a.setState({loading:!0});var e=a.props.models.Schedule,t=a.state.date;e.single(t[0],{attributes:["id","open","close","date","tolerance","processing_time","break_start","break_end","operator"]}).then(function(e){return a.setState({times:e.timeList,loading:!1,error:!1,purpose_key:1e3*Math.random()},function(){return a.getPurposes()})}).catch(function(){return a.setState({error:!0,loading:!1})})},a.toggleDate=function(e){e===a.state.date?a.setState({date:void 0}):a.setState({date:e})},a.dateChange=function(e){a.setState({date:e,time:void 0,clock:void 0},function(){a.getHours(!0),a.getPurposes()})},a.next=function(){var e=a.state,t=e.time,n=e.clock,r=e.date;a.props.next({time:t,clock:n,date:r})},a.onChange=function(e){var t=e.target,n=t.name,r=t.value,s=t.type;"name"===n?(""===r||r.match(/^[a-zA-Z ,._]+$/))&&a.setState(Object(d.a)({},e.target.name,e.target.value)):"number"===s?(""===r.toString()||r.match(/[0-9]/g))&&r.toString().length<=16&&a.setState(Object(d.a)({},e.target.name,e.target.value)):a.setState(Object(d.a)({},e.target.name,e.target.value))},a.onSelectChange=function(e){var t=a.props.models.Purpose;a.setState({purpose:e,purpose_id:e.value},function(){t.single(a.state.purpose.value).then(function(e){return a.setState({requirements:e.requirements.map(function(e){return Object(u.a)({},e,{image:!1})})})})})},a.select=function(e){var t=a.state,n=t.documents,r=t.requirements;n.push(e),r.find(function(t){return t.name===e.name}).image=!0,a.setState({documents:n,requirements:r})},a.calculateSize=function(e){var t="".concat(e).split(","),a=Object(m.a)(t,2)[1];return 4*Math.ceil(a.length/3)*.5624896334383812/1e3},a.cancel=function(e){var t=a.state.documents.filter(function(t){return t.name!==e});a.setState({documents:t})},a.submit=function(){var e=a.props.models.Queue,t=a.state,n=t.date,r=t.phone,s=t.nik,l=t.name,c=t.documents,o=t.purpose_id,i=t.token,m=t.clock,u=t.requirements;u.filter(function(e){return!e.image&&e.required}).length>0?(alert("Masukkan file: \n- ".concat(u.filter(function(e){return e.required}).map(function(e){return e.name}).join("\n- ")," untuk melanjutkan")),a.confirmRegister.close(),a.setState({upload:!0})):(a.confirmRegister.close(),a.setState({submitting:!0,submitErrors:[]}),console.log(c),e.create({date:f()(n[0]).format("YYYY-MM-DD"),time:m,phone:r,nik:s,name:l.toUpperCase(),documents:c,purpose_id:o,token:i}).then(function(e){a.setState({queue:e.$rawJSON,date:"",clock:void 0,clock_id:void 0,time:void 0,name:"",phone:0,nik:0,documents:[],purpose_id:void 0,modal:!0,requirements:[],submitting:!1,errors:{name:!1,nik:!1,phone:!1,captcha:!1},key:Math.random()}),localStorage.setItem("queue_number",e.queue_number)}).catch(function(e){var t=e.errors;a.setState({submitErrors:{errors:t},submitting:!1,captcha:"",modal:!0,key:Math.random(),error:!0},a.getHours)}))},a.validate=function(){var e=a.state,t=e.phone,n=e.nik,r=e.name,s=e.purpose_id,l=e.captcha,c=e.errors,o=e.clock;c.purpose_id=!(s>0),c.captcha=""===l,c.name=""===r,c.nik=""===n,c.phone=""===t,"undefined"===typeof o&&a.setState({collapse:!0}),a.setState({errors:c}),document.querySelector(".wrapper").scrollTop=0},a.toggleCollapse=function(){a.setState({collapse:!a.state.collapse})},a.onCollapseOpen=function(){var e=a.state.clock_id,t=document.querySelector("div.wrapper");if(void 0!==e){var n=document.querySelector("div#".concat(e));t.scrollTo(0,n.getBoundingClientRect().y)}},a.setToken=function(e){console.log(e),a.setState({token:e})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.queue,n=t.name,r=t.purpose_id,s=t.phone,l=t.nik,c=t.errors,o=c.name,m=c.nik,u=c.phone,d=c.purpose_id,g=t.key,E=t.purpose_key,q=this.state.times;return q=q.filter(function(e){return e.operator_left>0}),i.a.createElement(i.a.Fragment,null,this.state.submitting&&i.a.createElement(G,null),i.a.createElement(I,null,i.a.createElement(k.a,{className:"border-0 shadow"},i.a.createElement(v.a,null,i.a.createElement("div",{ref:function(t){return e.cont=t},className:"d-flex flex-row justify-content-between align-items-center"},i.a.createElement(p.b,{to:"/",color:"sm",outline:!0,className:"btn btn-outline-dark btn-sm d-inline"},i.a.createElement(A.b,null)),i.a.createElement(y.a,{className:"m-0"},i.a.createElement(A.d,{size:"1.5em"}),"\xa0Booking Antrian"))),i.a.createElement(N.a,null,i.a.createElement(S.a,{className:"my-1"},"Pilih Tanggal"),this.state.dates.length>0?i.a.createElement(b.a,{options:{enable:this.state.dates},onChange:this.dateChange,className:"form-control",value:this.state.date}):this.state.error?i.a.createElement(j.a,{disabled:!0,value:"Booking tidak dibuka pada ".concat(f()(this.state.date[0]).format("dddd, DD MMMM YYYY"))}):i.a.createElement(j.a,{disabled:!0,value:"Mengambil tanggal"}),i.a.createElement(S.a,{className:"my-1"},"Pilih Tujuan Mengantri"),this.state.purposes.length>0?i.a.createElement(T.a,{options:this.state.purposes,key:E,isOptionDisabled:function(e){return e.disabled},placeholder:"Pilih Tujuan",value:this.state.purpose,onChange:this.onSelectChange}):i.a.createElement(j.a,{disabled:!0,placeholder:"Mengambil daftar tujuan mengantri"}),d&&i.a.createElement("p",{className:"small text-danger"},"Pilih tujuan mengantri"),this.state.requirements.length>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(M.a,{block:!0,size:"sm",onClick:function(){return e.setState({upload:!e.state.upload})},className:"mt-3",outline:!0,color:"success"},"Lihat persyaratan / Upload berkas"),i.a.createElement(O.a,{isOpen:this.state.upload},i.a.createElement("hr",null),this.state.requirements.length>0&&i.a.createElement("p",{className:"text-muted small"},"Pengantri harap membawa dokumen sebagai berikut"),i.a.createElement("div",{className:"row justify-content-md-center"},this.state.requirements.map(function(e,t){return i.a.createElement(U,Object.assign({},e,{key:t}))})),this.state.requirements.length>0&&i.a.createElement("p",{className:"text-muted small"},"Atau upload berkas di sini"),i.a.createElement("div",{className:"row"},this.state.requirements.map(function(t,a){return i.a.createElement(F,{onCancel:e.cancel,file:t.name,onSelect:e.select,required:t.required,key:a})})),i.a.createElement("hr",null))),i.a.createElement(S.a,{className:"my-1"},"NIK Pengantri"),i.a.createElement(j.a,{invalid:m,maxLength:16,disabled:this.state.submitting,name:"nik",value:this.state.nik,onChange:this.onChange,type:"number",className:"my-1",placeholder:"NIK Pengantri"}),m&&i.a.createElement(x.a,{invalid:!0},"Masukkan NIK pengantri"),i.a.createElement(S.a,{className:"m-0"},"Nama Lengkap"),i.a.createElement(j.a,{invalid:o,disabled:this.state.submitting,name:"name",value:this.state.name,onChange:this.onChange,placeholder:"Nama pengantri",type:"text",className:"my-1"}),o&&i.a.createElement(x.a,{invalid:!0},"Masukkan Nama Lengkap"),i.a.createElement(S.a,{className:"m-0"},"Nomor Telepon"),i.a.createElement(j.a,{invalid:u,maxLength:13,disabled:this.state.submitting,name:"phone",value:this.state.phone,onChange:this.onChange,placeholder:"Nomor Telepon",type:"number",className:"my-1"}),u&&i.a.createElement(x.a,{invalid:!0},"Masukkan Nomor Telepon"),i.a.createElement("hr",null),void 0===this.state.time&&i.a.createElement(M.a,{block:!0,outline:!0,onClick:this.toggleCollapse,color:"primary"},"Pilih jam antri"),i.a.createElement(C.a,{color:"danger",isOpen:this.state.error},"Booking tidak dibuka pada ",f()(this.state.date[0]).format("dddd, DD MMMM YYYY")),i.a.createElement(O.a,{onEntered:this.onCollapseOpen,isOpen:this.state.collapse},i.a.createElement("hr",null),this.state.dates.length>0&&i.a.createElement(i.a.Fragment,null,this.state.loading?i.a.createElement("h4",{className:"text-center m-0"},i.a.createElement(D.a,{color:"primary"}),"\xa0Loading"):i.a.createElement("div",{className:"row no-gutters"},"undefined"!==typeof this.state.times&&0===q.length?i.a.createElement("p",{className:"text-center m-0 text-muted"},"Tanggal ",f()(this.state.date[0]).format("DD MMMM YYYY")," telah di-booking penuh"):i.a.createElement(i.a.Fragment,null,q.map(function(t,a){return i.a.createElement(h,Object.assign({active:e.state.time===a,idClock:"time-".concat(a),date:e.state.date,onClick:e.toggleClock.bind(e,a,t.time,"time-".concat(a)),key:a},t,{id:a}))}))))),void 0!==this.state.time&&i.a.createElement(i.a.Fragment,null,i.a.createElement(M.a,{block:!0,onClick:this.toggleCollapse,className:"my-2",color:"dark"},this.state.clock)),i.a.createElement("hr",null),i.a.createElement(R.ReCaptcha,{sitekey:"6Lc259UUAAAAANmApCOJJboq3_AeAYTZiJqg5M6W",action:"verify_register",verifyCallback:this.setToken,key:g}),void 0!==this.state.time&&""!==n&&""!==l&&""!==s&&void 0!==r?i.a.createElement(M.a,{onClick:function(){return e.confirmRegister.open()},color:"success"},"Daftar"):i.a.createElement(M.a,{color:"success",onClick:this.validate,type:"button"},"Daftar"))),i.a.createElement(H,{name:this.state.name,date:this.state.date,purpose:this.state.purpose.label,ref:function(t){return e.confirmRegister=t},time:this.state.clock,onClick:this.submit}),i.a.createElement(w.a,{isOpen:this.state.modal},"undefined"===typeof this.state.submitErrors.errors?"":i.a.createElement(Y.a,{className:"".concat(this.state.submitErrors.errors.length>0?"bg-danger":"bg-success"," text-white")},"".concat(this.state.submitErrors.errors.length>0?"Pendaftaran Gagal":"Pendaftaran Berhasil")),Object.keys(a).length>0&&i.a.createElement(Y.a,{className:"".concat(0===Object.keys(a).length?"bg-danger":"bg-success"," text-white")},"".concat(0===Object.keys(a).length?"Pendaftaran Gagal":"Pendaftaran Berhasil")),i.a.createElement(_.a,null,Object.keys(a).length>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement("h1",{className:"m-0 text-center text-success"},i.a.createElement(z.d,{size:"2em"})),i.a.createElement("h4",{className:"m-0 font-weight-light text-center"},a.name),i.a.createElement("p",{className:"m-0 text-muted text-center"},"Antrian tanggal ",f()(a.date).format("dddd, DD MMMM YYYY")),i.a.createElement("hr",null),i.a.createElement("p",{className:"m-0"},"Nomor antrian : ",a.queue_number),i.a.createElement("p",{className:"m-0"},"Jam : ",a.time),i.a.createElement("hr",null),i.a.createElement(p.b,{to:"/",className:"btn btn-primary"},"Kembali")),"undefined"===typeof this.state.submitErrors.errors?"":0===this.state.submitErrors.errors.length?"":i.a.createElement(i.a.Fragment,null,i.a.createElement("p",{className:"my-2 text-center text-danger"},i.a.createElement(z.f,{size:"6em"})),"undefined"===typeof this.state.submitErrors.errors?"":this.state.submitErrors.errors.map(function(e){return i.a.createElement(C.a,{color:"danger",className:"my-2",key:e.msg},e.msg)}),i.a.createElement("hr",null),i.a.createElement(M.a,{onClick:function(){return e.setState({modal:!1})},color:"danger"},"Tutup")),this.state.error&&i.a.createElement("p",null,this.state.errors.toString())))))}}]),t}(o.Component)),U=function(e){return i.a.createElement("div",{className:"col-md-6"},i.a.createElement(C.a,{color:"info"},e.name))},G=function(){return i.a.createElement("div",{className:"loading-container"},i.a.createElement(D.a,{color:"light",size:"lg",className:"my-2"}),i.a.createElement("h5",{className:"m-0 text-white"},"Mengirim data"))};a.d(t,"default",function(){return W});var W=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){f.a.locale("id")}},{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(K,{models:this.props.models}))}}]),t}(o.Component)}}]);
//# sourceMappingURL=11.c693cfb1.chunk.js.map